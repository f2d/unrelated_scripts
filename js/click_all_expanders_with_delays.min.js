(function(){
var targetTextParts=[/\d+\s+repl(y|ies)/i,'read more','more replies','show more','see more','load more comment','[+]','loading...','note','показать','раскрыть ветку','комментари',/Ещё\s+\d+\s+комментари/i,/Показать\s+\d+\s+ответ/i,'ещё',' ответ','▼','[show replies]','more>>','spoiler','expand'];
var targetCssClasses=['comment__more','comment__load-more','expand','button','PostTextMore','wall_post_more','wall_reply_more','mw-collapsible-text','NavToggle','HQToggle','notelabel','comment-toggle-children_collapse','comment-hidden-group__toggle','community-info-block__read-more-label','story__read-more-label','shesht-comments-block-form-readmore','toggle-comment','ytd-continuation-item-renderer','more-button','comment-more-button_child','comments2--more-comments-button__block-3P','comments2--root-comment__textBtn-1S','comments2--rich-text__expandWord-2_','showreplies','ml-px','morelink','sp-head','load-more-button',/LoadMoreButton_load-more__\S/i,/ReplyList_view-all-replies__\S/i,/styles_lia-g-loader-btn__\S/i];
var skipCssClasses=['unfolded'];
var unskipTextParts=['load more comments','loading...'];
var clickableTagNames=['a','button'];
var doneElements=[];
function openAllVisibleExpanders(){var pendingTotalCount=0;var pendingIndex=0;var pendingElements=[];
function checkPendingElement(e){if(window.stopOpeningExpanders){
console.log(pendingIndex+' / '+pendingTotalCount+' skipped');}else if(e=pendingElements[pendingIndex]){
console.log(pendingIndex+' / '+pendingTotalCount+' = '+e.textContent.replace(/^\s+|\s+$/g,'').replace(/\s+/g,' '));(getClickableChild(e)||e).click();}if(!window.stopOpeningExpanders){if(pendingIndex<pendingTotalCount){++pendingIndex;setTimeout(checkPendingElement,(Math.ceil(pendingIndex/50)+Math.random())*900);}else{
console.log('Retrying...');setTimeout(openAllVisibleExpanders,1234);}}}
function getClickableChild(e,a){
for(var eachTagName of clickableTagNames){if(e.tagName.toLowerCase()===eachTagName)return e;if(a=e.getElementsByTagName(eachTagName)[0])return a;}}
function isTextMatch(matchRules,text,textLowerCase){
for(var eachRule of matchRules)if(eachRule.test?eachRule.test(text):(text.includes(eachRule)||textLowerCase.includes(eachRule)))return true;}
function checkLinkElement(eachLinkElement){
for(var eachSkipName of skipCssClasses)if(eachSkipName.test?eachSkipName.test(eachLinkElement.className):eachLinkElement.classList.contains(eachSkipName))return;var style,testElement=eachLinkElement;while(testElement){if(testElement.hidden||doneElements.includes(testElement)||((style=testElement.style)&&(style.opacity===0||style.display==='none'||style.visibility==='hidden')))return;testElement=testElement.parentNode;}if(linkTextContent=eachLinkElement.textContent){var linkTextLowerCase=linkTextContent.toLowerCase();if(isTextMatch(targetTextParts,linkTextContent,linkTextLowerCase)){++pendingClassCount;++pendingTotalCount;pendingElements.push(eachLinkElement);if(!isTextMatch(unskipTextParts,linkTextContent,linkTextLowerCase)){doneElements.push(eachLinkElement);}}}}
for(var eachCssClass of targetCssClasses){var pendingClassCount=0;if(eachCssClass.test){
for(var eachTagName of clickableTagNames)
for(var eachLinkElement of document.getElementsByTagName(eachTagName))if(eachCssClass.test(eachLinkElement.className)){checkLinkElement(eachLinkElement);}}else{
for(var eachLinkElement of document.getElementsByClassName(eachCssClass)){checkLinkElement(eachLinkElement);}}if(pendingClassCount>0)
console.log('Found '+pendingClassCount+' targets of class "'+eachCssClass+'" ');}
console.log('Total visible targets: '+pendingTotalCount);if(!window.stopOpeningExpanders){if(pendingTotalCount){setTimeout(checkPendingElement,1234);}else{setTimeout(openAllVisibleExpanders,12345);}}}
openAllVisibleExpanders();
})(window.stopOpeningExpanders=0)